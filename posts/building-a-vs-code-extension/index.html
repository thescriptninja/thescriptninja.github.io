<!DOCTYPE html>
<html><head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Building a VS Code extension - Parth Paradkar</title><meta name="viewport" content="width=device-width, initial-scale=1">

	<meta property="og:image" content=""/>
	<meta property="og:title" content="Building a VS Code extension" />
<meta property="og:description" content="Quite an unnecessary one tbh" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://parth-paradkar.me/posts/building-a-vs-code-extension/" />
<meta property="article:published_time" content="2021-05-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-05-04T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Building a VS Code extension"/>
<meta name="twitter:description" content="Quite an unnecessary one tbh"/>
<script src="https://parth-paradkar.me/js/feather.min.js"></script>
	
	<link href="https://parth-paradkar.me/css/fonts.css" rel="stylesheet">
	
	<link rel="stylesheet" type="text/css" media="screen" href="https://parth-paradkar.me/css/main.css" />
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://parth-paradkar.me/">Parth Paradkar</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/about">About</a>
		
		<a href="/tags">Tags</a>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Building a VS Code extension</h1>
			<div class="meta">Posted on May 4, 2021</div>
		</div>
		

		<section class="body">
			<h2 id="motivation">Motivation</h2>
<p>I have been writing TILs(short notes about what I learned each day) in Dendron for a few days now, for which I need to specify the date of each TIL. Since looking at the date in the top right corner and typing a few characters out was excruciatingly painful, I used to get this from the <code>date</code> shell command. This required me to open a terminal in VS Code (I usually don’t have one open when I am writing notes), enter the command, copy the output and paste it where I required it. As this too was proving to be an insane amount of effort, I had to automate it. Obviously.</p>
<h2 id="but-why-not-use-keybindings-directly">But why not use keybindings directly?</h2>
<p>Well, that’s what I thought.</p>
<p>Initially, I stuck to my approach of getting the date from the shell command and somehow transferring it to the text editor in focus. The next logical step was to get the output of the command into the clipboard. After that, it could be pasted into the editor automatically. The aim was to achieve all this with a single keystroke or key combination.</p>
<p>To transfer the output of the <code>date</code> command to the clipboard, I came across <code>xclip</code> and it worked pretty good.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"> date | xclip -sel clip
</code></pre></div><p>This command pipes the output of date to the clipboard. Now, how to run this in the VS Code environment?</p>
<p>Apparently, keybindings can only call methods available in the VS Code API directly. To attach a keybinding to a shell command, I found that an extension has to be installed. Using this extension, I was able to attach the above command to a preferred key combination. This was done by adding an entry in the <code>keybindings.json</code> file as follows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JSON" data-lang="JSON">{
    <span style="color:#f92672">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;ctrl+m d&#34;</span>,
    <span style="color:#f92672">&#34;command&#34;</span>: <span style="color:#e6db74">&#34;terminalCommandKeys.run&#34;</span>,
    <span style="color:#f92672">&#34;args&#34;</span>: {
        <span style="color:#f92672">&#34;cmd&#34;</span>: <span style="color:#e6db74">&#34;date | xclip -sel clip&#34;</span>,
        <span style="color:#f92672">&#34;newTerminal&#34;</span>: <span style="color:#66d9ef">false</span>,
        <span style="color:#f92672">&#34;showTerminal&#34;</span>: <span style="color:#66d9ef">false</span>
    }
 }
</code></pre></div><p>Now the task was to transfer the text from the clipboard to the position of the cursor. This had to be done using the VS Code API. This is where the problem started. Apparently, VS Code does not allow you to run multiple commands with a single key. It has been a long requested feature in VS Code and the only workarounds are awkward macros and tasks. There is really no straightforward way to combine the above shell command with a VS Code API call. You could argue that I could just do <code>Ctrl+V</code> after the xclip stage, but anything less than full automation is for peasants.</p>
<h2 id="big-brain-time">Big Brain Time</h2>
<p>So I decided to write an VS Code extension. I had already found an <a href="https://github.com/jsynowiec/vscode-insertdatestring">one</a> that already did exactly what I wanted. However, I was already too deeply invested in the idea of building an extension, so decided to go ahead anyways.</p>
<p>Honestly, it was much easier than expected. The <a href="https://code.visualstudio.com/api/get-started/your-first-extension">first page of the official guide</a> is really all you need to build an extension of this scope at least. The scaffolding generated by <a href="https://yeoman.io/">yeoman</a> does half the job for you. All that was left to do is write some simple code in the <a href="https://github.com/parth-paradkar/ClipDate/blob/master/src/extension.ts">extension.ts</a> file, where I modified the <code>activate</code> function to insert the date at the current position of the cursor. As using the shell command no longer made sense, so I used the inbuilt <code>Date</code> class in TypeScript to format the date as required. I also threw in a function that returned the UTC date in addition to the normal date (because why not).</p>
<p>After this, I edited the <a href="https://github.com/parth-paradkar/ClipDate/blob/master/package.json">package.json</a> to add commands and the corresponding keybindings. That was all the programming needed :)</p>
<p>After testing it locally, I published it it on the VS Code marketplace. You can find it <a href="https://marketplace.visualstudio.com/items?itemName=parth-paradkar.clipdate">here</a> or by searching for <code>clipDate</code> in the extension marketplace inside VS Code.</p>
<h2 id="final-thoughts">Final thoughts</h2>
<p>The end result was pretty neat I thought. I finally could enter the date with a single key combination (<code>Ctrl+Alt+D</code>) :D. You can find the code <a href="https://github.com/parth-paradkar/ClipDate">here</a>.</p>
<p>While the extension is pretty lame, I learned a little bit about the VS Code API and how to use it to build an extension. I also learned to test and publish the extension. Not a bad use of an empty Monday evening :)</p>

		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/tech">tech</a></li>
					
				</ul>
			</nav>
			
			
		</div>
	</article>
	
	<script src="https://utteranc.es/client.js"
        	repo="parth-paradkar/parth-paradkar.github.io"
	        issue-term="pathname"
	        label="comment"
	        theme="preferred-color-scheme"
	        crossorigin="anonymous"
	        async>
	</script>
	
</main>
<footer>
<hr><a class="soc" href="https://github.com/parth-paradkar" title="GitHub"><i data-feather="github"></i></a>|<a class="soc" href="https://twitter.com/parthparadkar_" title="Twitter"><i data-feather="twitter"></i></a>|⚡️
	2021  <a href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
</footer>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-179536383-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<script>
      feather.replace()
</script></div>
    </body>
</html>
